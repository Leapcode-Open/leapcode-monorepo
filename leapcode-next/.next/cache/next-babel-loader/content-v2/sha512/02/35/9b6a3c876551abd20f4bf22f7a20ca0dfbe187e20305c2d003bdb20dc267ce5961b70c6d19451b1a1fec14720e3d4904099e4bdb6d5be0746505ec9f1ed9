{"ast":null,"code":"import _defineProperty from \"/Users/stanly/Documents/projects/leapcode-next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/stanly/Documents/projects/leapcode-next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/stanly/Documents/projects/leapcode-next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { auth } from \"./firebase\";\nimport cookies from 'next-cookies';\nimport jscookie from 'js-cookie';\nexport var COOKIE_TOKEN = 'lptoken';\nexport var API_URL = process.env.NEXT_PUBLIC_APIURL;\nexport var SERVER_API_KEY = process.env.SERVER_API_KEY ? process.env.SERVER_API_KEY : 'notoken';\nexport var getToken = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var co, token;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return jscookie.get('lptoken');\n\n          case 2:\n            co = _context.sent;\n            token = co ? co : 'notokeb';\n            return _context.abrupt(\"return\", token);\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function getToken() {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var API_HEADERS = {\n  'Accept': 'application/json',\n  'Content-Type': 'application/json',\n  'authorization': \"Bearer \".concat(getToken())\n};\nexport var GET_TOKEN_HEADER = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.t0 = \"Bearer \";\n            _context2.next = 3;\n            return getToken();\n\n          case 3:\n            _context2.t1 = _context2.sent;\n            _context2.t2 = _context2.t0.concat.call(_context2.t0, _context2.t1);\n            return _context2.abrupt(\"return\", {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json',\n              'authorization': _context2.t2\n            });\n\n          case 6:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function GET_TOKEN_HEADER() {\n    return _ref2.apply(this, arguments);\n  };\n}();\n_c = GET_TOKEN_HEADER;\nexport var GET_SERVER_TOKEN_HEADER = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(ctx) {\n    var _cookies, lptoken;\n\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _cookies = cookies(ctx), lptoken = _cookies.lptoken;\n            return _context3.abrupt(\"return\", {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json',\n              'authorization': \"Bearer \".concat(lptoken),\n              'server-access-key': \"\".concat(SERVER_API_KEY)\n            });\n\n          case 2:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function GET_SERVER_TOKEN_HEADER(_x) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n_c2 = GET_SERVER_TOKEN_HEADER;\nexport var GET_AUTH_USER_DETAILS = /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(ctx) {\n    var _cookies2, lptoken, user;\n\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _cookies2 = cookies(ctx), lptoken = _cookies2.lptoken;\n\n            if (lptoken) {\n              _context4.next = 3;\n              break;\n            }\n\n            return _context4.abrupt(\"return\", false);\n\n          case 3:\n            _context4.t0 = fetch;\n            _context4.t1 = API_URL + \"/auth/authUser/\";\n            _context4.next = 7;\n            return GET_SERVER_TOKEN_HEADER(ctx);\n\n          case 7:\n            _context4.t2 = _context4.sent;\n            _context4.t3 = {\n              headers: _context4.t2\n            };\n            _context4.next = 11;\n            return (0, _context4.t0)(_context4.t1, _context4.t3);\n\n          case 11:\n            user = _context4.sent;\n            _context4.next = 14;\n            return user.json();\n\n          case 14:\n            user = _context4.sent;\n            return _context4.abrupt(\"return\", _objectSpread({}, user));\n\n          case 16:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n\n  return function GET_AUTH_USER_DETAILS(_x2) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n_c3 = GET_AUTH_USER_DETAILS;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"GET_TOKEN_HEADER\");\n$RefreshReg$(_c2, \"GET_SERVER_TOKEN_HEADER\");\n$RefreshReg$(_c3, \"GET_AUTH_USER_DETAILS\");","map":{"version":3,"sources":["/Users/stanly/Documents/projects/leapcode-next/config/constants.js"],"names":["auth","cookies","jscookie","COOKIE_TOKEN","API_URL","process","env","NEXT_PUBLIC_APIURL","SERVER_API_KEY","getToken","get","co","token","API_HEADERS","GET_TOKEN_HEADER","GET_SERVER_TOKEN_HEADER","ctx","lptoken","GET_AUTH_USER_DETAILS","fetch","headers","user","json"],"mappings":";;;;;;;;AAAA,SAASA,IAAT,QAAqB,YAArB;AACA,OAAOC,OAAP,MAAoB,cAApB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAO,IAAMC,YAAY,GAAG,SAArB;AACP,OAAO,IAAMC,OAAO,GAAGC,OAAO,CAACC,GAAR,CAAYC,kBAA5B;AACP,OAAO,IAAMC,cAAc,GAAGH,OAAO,CAACC,GAAR,CAAYE,cAAZ,GAA6BH,OAAO,CAACC,GAAR,CAAYE,cAAzC,GAA2D,SAAlF;AAEP,OAAO,IAAMC,QAAQ;AAAA,sEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEHP,QAAQ,CAACQ,GAAT,CAAa,SAAb,CAFG;;AAAA;AAEdC,YAAAA,EAFc;AAGdC,YAAAA,KAHc,GAGND,EAAE,GAAGA,EAAH,GAAQ,SAHJ;AAAA,6CAIbC,KAJa;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAARH,QAAQ;AAAA;AAAA;AAAA,GAAd;AAOP,OAAO,IAAMI,WAAW,GAAG;AACvB,YAAU,kBADa;AAEvB,kBAAgB,kBAFO;AAGvB,oCAA2BJ,QAAQ,EAAnC;AAHuB,CAApB;AAOP,OAAO,IAAMK,gBAAgB;AAAA,uEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAGKL,QAAQ,EAHb;;AAAA;AAAA;AAAA;AAAA;AAC5B,sBAD4B,EAClB,kBADkB;AAE5B,4BAF4B,EAEZ,kBAFY;AAG5B,6BAH4B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAhBK,gBAAgB;AAAA;AAAA;AAAA,GAAtB;KAAMA,gB;AAOb,OAAO,IAAMC,uBAAuB;AAAA,uEAAG,kBAAOC,GAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,uBACff,OAAO,CAACe,GAAD,CADQ,EAC3BC,OAD2B,YAC3BA,OAD2B;AAAA,8CAE5B;AACH,wBAAU,kBADP;AAEH,8BAAgB,kBAFb;AAGH,gDAA2BA,OAA3B,CAHG;AAIH,6CAAwBT,cAAxB;AAJG,aAF4B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAvBO,uBAAuB;AAAA;AAAA;AAAA,GAA7B;MAAMA,uB;AAWb,OAAO,IAAMG,qBAAqB;AAAA,uEAAG,kBAAOF,GAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,wBACbf,OAAO,CAACe,GAAD,CADM,EACzBC,OADyB,aACzBA,OADyB;;AAAA,gBAE7BA,OAF6B;AAAA;AAAA;AAAA;;AAAA,8CAGtB,KAHsB;;AAAA;AAAA,2BAIhBE,KAJgB;AAAA,2BAIVf,OAAO,oBAJG;AAAA;AAAA,mBAKdW,uBAAuB,CAACC,GAAD,CALT;;AAAA;AAAA;AAAA;AAK7BI,cAAAA,OAL6B;AAAA;AAAA;AAAA;;AAAA;AAI7BC,YAAAA,IAJ6B;AAAA;AAAA,mBAOpBA,IAAI,CAACC,IAAL,EAPoB;;AAAA;AAOjCD,YAAAA,IAPiC;AAAA,gEAS1BA,IAT0B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAArBH,qBAAqB;AAAA;AAAA;AAAA,GAA3B;MAAMA,qB","sourcesContent":["import { auth } from \"./firebase\";\nimport cookies from 'next-cookies';\nimport jscookie from 'js-cookie';\nexport const COOKIE_TOKEN = 'lptoken';\nexport const API_URL = process.env.NEXT_PUBLIC_APIURL;\nexport const SERVER_API_KEY = process.env.SERVER_API_KEY ? process.env.SERVER_API_KEY  : 'notoken';\n\nexport const getToken = async () => {\n    //const token = auth().currentUser ? await auth().currentUser.getIdToken() : 'notokeb';\n    const co = await jscookie.get('lptoken');\n    const token = co ? co : 'notokeb'\n    return token;\n}\n\nexport const API_HEADERS = {\n    'Accept': 'application/json',\n    'Content-Type': 'application/json',\n    'authorization': `Bearer ${getToken()}`\n}\n\n\nexport const GET_TOKEN_HEADER = async () => ({\n    'Accept': 'application/json',\n    'Content-Type': 'application/json',\n    'authorization': `Bearer ${await getToken()}`\n})\n\n\nexport const GET_SERVER_TOKEN_HEADER = async (ctx) => {\n    const { lptoken } = cookies(ctx);\n    return({\n        'Accept': 'application/json',\n        'Content-Type': 'application/json',\n        'authorization': `Bearer ${lptoken}`,\n        'server-access-key': `${SERVER_API_KEY}` \n    })\n}\n\n\nexport const GET_AUTH_USER_DETAILS = async (ctx) => {\n    const { lptoken } = cookies(ctx);\n    if(!lptoken)\n        return false\n    let user = await fetch(API_URL+`/auth/authUser/`, {\n        headers: await GET_SERVER_TOKEN_HEADER(ctx)\n    })\n    user = await user.json();\n    return {\n        ...user\n    }\n}"]},"metadata":{},"sourceType":"module"}